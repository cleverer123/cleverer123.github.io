---
layout:     post
title:      "蒙特卡罗方法"
subtitle:   ""
date:       2018-03-29
author:     "Leo"
header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
    - Monte Carlo
---

### 什么是蒙特卡罗方法

以下内容来之知乎：

最早的**蒙特卡罗方法**是由物理学家发明的，旨在通过随机化方法计算积分，假设给定函数$$h(x)$$，我们想计算如下积分

$$\int_{a}^{b}h(x)dx.$$

如果我们无法通过数学推导求出解析解，那么，为了避免对区间（a,b）上所有的x进行枚举，我们可以将$$h(x)$$分解为某个函数$$f(x)$$和一个定义在(a,b)上的概率密度函数$$p(x)$$的乘积。这样整个积分就可以写成

$$\int_{a}^{b}h(x)dx=\int_{a}^{b}f(x)p(x)dx=E_{p(x)}[f(x)]$$

这样，原积分就等同于$$f(x)$$在$$p(x)$$这个分布上的期望。这时，如果我们从分布$$p(x)$$上采集的大量样本点$$x_1,x_2,...,x_n$$，这些样本符合分布$$p(x)$$。

那么，我们就可以通过这些样本来逼近这个均值

$$\int_{a}^{b}h(x)dx=E_{p(x)}[f(x)] \approx \frac{1}{n} \sum_{i=1}^{n}f(x_i).$$

这就是蒙特卡罗方法的**基本思想**。

一般来讲，对于经典的分布，例如对于均匀分布和正态分布等，都已经有比较成熟的算法可以快速的直接生成该分布的无偏（unbiased）样本。然而，对于任意的分布，我们并不能做到这一点。那么，如何在任意分布下采样呢？这就是**马尔可夫链蒙特卡罗方法（Markov Chain Monte Carlo，MCMC)**需要解决的问题。

后续阅读马尔可夫链蒙特卡罗方法（Markov Chain Monte Carlo，MCMC).

### 蒙特卡罗（Monte Carlo）VS 拉斯维加斯（Las Vegas）

以下内容来自知乎：

这里把随机算法分成两类：

1 蒙特卡罗算法：采样越多，越近似最优解；

2 拉斯维加斯算法：采样越多，越有机会找到最优解；

- 举个例子，假如筐里有100个苹果，让我每次闭眼拿1个，挑出最大的。于是我随机拿1个，再随机拿1个跟它比，留下大的，再随机拿1个……我每拿一次，留下的苹果都至少不比上次的小。拿的次数越多，挑出的苹果就越大，但我除非拿100次，否则无法肯定挑出了最大的。这个挑苹果的算法，就属于蒙特卡罗算法——尽量找好的，但不保证是最好的。

- 而拉斯维加斯算法，则是另一种情况。假如有一把锁，给我100把钥匙，只有1把是对的。于是我每次随机拿1把钥匙去试，打不开就再换1把。我试的次数越多，打开（最优解）的机会就越大，但在打开之前，那些错的钥匙都是没有用的。这个试钥匙的算法，就是拉斯维加斯的——尽量找最好的，但不保证能找到。

这两个词并不深奥，它只是概括了随机算法的特性，算法本身可能复杂，也可能简单。这两个词本身是两座著名赌城，因为赌博中体现了许多随机算法，所以借过来命名。这两类随机算法之间的选择，往往受到问题的局限。如果问题要求在**有限采样内，必须给出一个解，但不要求是最优解**，那就要用蒙特卡罗算法。反之，如果问题要求**必须给出最优解，但对采样没有限制**，那就要用拉斯维加斯算法。

对于机器围棋程序而言，因为每一步棋的运算时间、堆栈空间都是有限的，而且不要求最优解，所以ZEN涉及的随机算法，肯定是蒙特卡罗式的。机器下棋的算法本质都是搜索树，围棋难在它的树宽可以达到好几百（国际象棋只有几十）。在有限时间内要遍历这么宽的树，就只能牺牲深度（俗称“往后看几步”），但围棋又是依赖远见的游戏，甚至不仅是看“几步”的问题。所以，要想保证搜索深度，就只能放弃遍历，改为随机采样——这就是为什么在没有MCTS（蒙特卡罗搜树）类的方法之前，机器围棋的水平几乎是笑话。而采用了MCTS方法后，搜索深度就大大增加了。

## 参考

- [蒙特卡罗算法是什么？ - 罗YQ的回答 - 知乎](https://www.zhihu.com/question/20254139/answer/69851821)
- [受限玻尔兹曼机（RBM）学习笔记（一）预备知识](https://blog.csdn.net/itplus/article/details/19168937)
- [蒙特卡罗算法是什么？ - 孙天齐的回答 - 知乎](https://www.zhihu.com/question/20254139/answer/33572009)
- [增强学习（四）蒙特卡罗方法(Monte Carlo Methods)](http://www.cnblogs.com/jinxulin/p/3560737.html)
